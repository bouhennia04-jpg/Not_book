<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>macOS Style Notes App with iOS Emojis</title>
<style>
  @font-face {
    font-family: 'iOS-Emoji';
    src: url('Emojis.ttf') format('opentype');
  }

  body {
  font-family: 'iOS-Emoji',-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    background-color: #f2f2f7;
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    padding-top: 50px;
  }

  .container {
    display: flex;
    width: 90%;
    max-width: 1200px;
    background-color: #ffffff;
    border-radius: 12px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.08);
    overflow: hidden;
    min-height: 700px;
  }

  .sidebar {
    width: 300px;
    border-right: 1px solid #e0e0e0;
    background-color: #f9f9f9;
    display: flex;
    flex-direction: column;
  }

  .sidebar-header {
    padding: 20px;
    border-bottom: 1px solid #e0e0e0;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .sidebar-header h2 {
    margin: 0;
    font-size: 20px;
    color: #333;
  }

  .sidebar-header button {
    background-color: #007aff;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 8px;
    font-size: 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 5px;
  }

  .sidebar-header button:hover {
    background-color: #005fcc;
  }

  .note-list {
    flex-grow: 1;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }

  .note-item {
    padding: 15px 20px;
    border-bottom: 1px solid #eee;
    cursor: pointer;
    transition: background-color 0.15s ease;
    position: relative;
  }

  .note-item:hover {
    background-color: #f0f0f0;
  }

  .note-item.active {
    background-color: #e0e0e0;
  }

  .note-item h3 {
    margin: 0 0 5px 0;
    font-size: 16px;
    color: #333;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .note-item p {
    margin: 0;
    font-size: 13px;
    color: #666;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .note-item small {
    font-size: 11px;
    color: #999;
    display: block;
    margin-top: 5px;
  }

  .delete-note-btn {
    background: none;
    border: none;
    color: #ff3b30;
    font-size: 16px;
    cursor: pointer;
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .note-item:hover .delete-note-btn {
    opacity: 1;
  }

  .main-content {
    flex-grow: 1;
    padding: 30px;
    display: flex;
    flex-direction: column;
  }

  .main-content.empty-state {
    display: flex;
    justify-content: center;
    align-items: center;
    color: #999;
    font-size: 18px;
  }

  .note-title-input {
    font-size: 28px;
    font-weight: bold;
    border: none;
    padding: 10px 0;
    margin-bottom: 15px;
    width: 100%;
    outline: none;
    color: #333;
    background-color: transparent;
    border-bottom: 1px solid transparent;
    transition: border-bottom-color 0.2s ease;
  }

  .note-title-input:focus {
    border-bottom-color: #e0e0e0;
  }

  .note-body-textarea {
    flex-grow: 1;
    font-size: 17px;
    line-height: 1.6;
    width: 100%;
    outline: none;
    color: #333;
    font-family: 'iOS-Emoji', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    white-space: pre-wrap;
    overflow-y: auto;
  }

  /* Scrollbar styling */
  .note-list::-webkit-scrollbar,
  .note-body-textarea::-webkit-scrollbar {
    width: 8px;
    background-color: #f1f1f1;
  }

  .note-list::-webkit-scrollbar-thumb,
  .note-body-textarea::-webkit-scrollbar-thumb {
    background-color: #c1c1c1;
    border-radius: 4px;
  }

  .note-list::-webkit-scrollbar-thumb:hover,
  .note-body-textarea::-webkit-scrollbar-thumb:hover {
    background-color: #a8a8a8;
  }
</style>
</head>
<body>
<div class="container">
  <div class="sidebar">
    <div class="sidebar-header">
      <h2>الملاحظات</h2>
      <button id="add-note-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2z"/>
        </svg>
        جديدة
      </button>
    </div>
    <div class="note-list" id="note-list"></div>
  </div>
  <div class="main-content" id="main-content">
    <div class="empty-state">
      حدد ملاحظة أو أنشئ ملاحظة جديدة.
    </div>
  </div>
</div>

<script>
const noteListDiv = document.getElementById('note-list');
const mainContentDiv = document.getElementById('main-content');
const addNoteBtn = document.getElementById('add-note-btn');

let notes = JSON.parse(localStorage.getItem('notes')) || [];
let activeNoteId = null;

function renderNoteList() {
  noteListDiv.innerHTML = '';
  notes.forEach(note => {
    const noteItem = document.createElement('div');
    noteItem.classList.add('note-item');
    if (note.id === activeNoteId) noteItem.classList.add('active');
    noteItem.dataset.id = note.id;

    const firstLine = note.body.split('\n')[0] || 'ملاحظة جديدة';
    const secondLine = note.body.split('\n')[1] || '';

    noteItem.innerHTML = `
      <h3>${note.title || firstLine}</h3>
      <p>${note.title ? firstLine : secondLine}</p>
      <small>${new Date(note.updatedAt).toLocaleString()}</small>
      <button class="delete-note-btn">✕</button>
    `;

    noteItem.addEventListener('click', (event) => {
      if (!event.target.classList.contains('delete-note-btn')) selectNote(note.id);
    });

    const deleteBtn = noteItem.querySelector('.delete-note-btn');
    deleteBtn.addEventListener('click', (event) => {
      event.stopPropagation();
      deleteNote(note.id);
    });

    noteListDiv.appendChild(noteItem);
  });
}

function renderNoteEditor(note) {
  mainContentDiv.innerHTML = `
    <input type="text" class="note-title-input" id="note-title" placeholder="عنوان الملاحظة" value="${note.title || ''}">
    <div id="note-body" class="note-body-textarea" contenteditable="true">${note.body}</div>
  `;
  mainContentDiv.classList.remove('empty-state');

  const noteTitleInput = document.getElementById('note-title');
  const noteBodyDiv = document.getElementById('note-body');

  noteTitleInput.addEventListener('input', (e) => updateNote(note.id, 'title', e.target.value));

  noteBodyDiv.addEventListener('input', () => {
    updateNote(note.id, 'body', noteBodyDiv.innerText);
    noteBodyDiv.style.height = 'auto';
    noteBodyDiv.style.height = noteBodyDiv.scrollHeight + 'px';
  });

  noteBodyDiv.focus();
}

function renderEmptyState() {
  mainContentDiv.innerHTML = `
    <div class="empty-state">
      حدد ملاحظة أو أنشئ ملاحظة جديدة.
    </div>
  `;
  mainContentDiv.classList.add('empty-state');
  activeNoteId = null;
  renderNoteList();
}

addNoteBtn.addEventListener('click', () => {
  const newNote = {
    id: Date.now().toString(),
    title: '',
    body: '',
    createdAt: new Date().toISOString(),
    updatedAt: new Date().toISOString(),
  };
  notes.unshift(newNote);
  saveNotes();
  selectNote(newNote.id);
});

function selectNote(id) {
  activeNoteId = id;
  const selectedNote = notes.find(n => n.id === id);
  if (selectedNote) {
    renderNoteEditor(selectedNote);
    renderNoteList();
  }
}

function updateNote(id, field, value) {
  const noteIndex = notes.findIndex(n => n.id === id);
  if (noteIndex > -1) {
    notes[noteIndex][field] = value;
    notes[noteIndex].updatedAt = new Date().toISOString();
    const [updatedNote] = notes.splice(noteIndex, 1);
    notes.unshift(updatedNote);
    saveNotes();
    renderNoteList();
  }
}

function deleteNote(id) {
  if (confirm('هل أنت متأكد أنك تريد حذف هذه الملاحظة؟')) {
    notes = notes.filter(n => n.id !== id);
    saveNotes();
    if (activeNoteId === id) renderEmptyState();
    else renderNoteList();
  }
}

function saveNotes() {
  localStorage.setItem('notes', JSON.stringify(notes));
}

function init() {
  if (notes.length > 0) selectNote(notes[0].id);
  else renderEmptyState();
  renderNoteList();
}

init();
</script>
</body>
</html>